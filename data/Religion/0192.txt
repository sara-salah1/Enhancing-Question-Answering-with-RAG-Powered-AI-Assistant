كانت أعظم المشكلات التي واجهت عبدالرحمن الداخل مؤامرة كبرى دبرها له بعض ثوار الأندلس من العرب المعارضين للأمويين، وذلك سنة 161ه/ 778م وما يليها، بالاتفاق مع الخليفة العباسي محمد المهدي (158 - 169هـ/ 775 - 785م) ومستعينين في ذلك بقارلة (شارلمان بن بيبان) ملك الفرنجة الذي كان على علاقة صداقة ومودة مع الخليفة العباسي بدافع من المصلحة المشتركة.ومن هؤلاء الثوار العرب عبدالرحمن بن حبيب الفهري الصقلبي، وقد ثار بتدمير سنة 163ه. كذلك ثار عليه سليمان بن يقظان الأعرابي والي برشلونة وثار معه بسرقسطة حسين بن يحيى الأنصاري من ولد سعد بن عبادة، وأخيراً ثار عليه الرماحس بن عبدالعزيز الكناني، والي الجزيرة الخضراء، سنة 164ه.ولم يكن قارلة يزهد في امتلاك الأندلس، فقد كان فرغ من حروبه في الجزء الأعظم من أوروبا، وضم إلى ملكه لمبارديا وسكسونيا وبافيير وبلاد الآفاريين وامتد ملكه حتى الدانوب. وكان قارلة يحلم بطرد المسلمين من الأندلس، ويطمع في ضم مملكة القوط القديمة إلى إمبراطوريته. ويبدو أن المؤامرة قد دبرت بعلم محمد المهدي العباسي وموافقته، وليس أدل على ذلك من التجاء الرماحس إليه بعد أن فشلت ثورته على ابن معاوية في الجزيرة الخضراء.وبدأ عبد الرحمن بن حبيب الفهري الصقلبي بالعبور إلى إفريقية، ثم عاد بجيش كبير من البربر نزل به في مدينة تدمير، التي ستصبح فيما بعد مدينة مرسية، وكانت مهمة سليمان بن يقظان الأعرابي الذهاب إلى سرقسطة وإعلان الثورة مع أحد المغامرين العرب، وهو حسين بن يحيى الأنصاري. وكان على الرماحس أن يعلن الثورة في جنوب الأندلس في الوقت نفسه. وكان لا بد لعبد الرحمن بن معاوية من أن يحارب هؤلاء الثوار الواحد بعد الآخر.وجه ابن معاوية همه لمقاتلة الرماحس، فأرسل إليه وزيره عبد الله بن خالد على رأس جيش، ففر الرماحس على مركب جاز به البحر حتى قدم إلى الخليفة العباسي. أما سليمان الأعرابي فقد ثار بسرقسطة وثار معه حسين بن يحيى الأنصاري، فبعث إليهما ابن معاوية قائده ثعلبة بن عبيد الجذامي في جيش. غير أن سليمان نجح في هزيمة هذا الجيش، وأسر ثعلبة. وعمل على الاستفادة من أسره. فترك على سرقسطة زميله حسين بن يحيى الأنصاري، ومضى هو وأسيره حيث قابل قارلة وسلمه ثعلبة، وحرضه على غزو شمال الأندلس.حملة شارلمان الفاشلةووجد قارلة في ذلك فرصة مواتية لغزو الأندلس، فخرج على رأس جيوشه في ربيع سنة 778م متجهاً نحو جبال البرتات (البيرينيه) فاجتازها إلى رنشفالة وهاجم بنبلونة واستولى عليها، ثم استمر في زحفه نحو سرقسطة، وهو يعتقد أنها ستفتح له أبوابها، إذ كان ابن الأعرابي قد مهد السبيل أمامه لدخولها. ويبدو أن حسين بن يحيى طمع في الانفراد بولاية سرقسطة، فأغلق أبوابها أمام جيوش قارلة، وأصم أذنيه عن توسلات ابن الأعرابي، وطال حصار قارلة للمدينة عبثاً حتى يئس من فتحها، وكانت الأنباء قد وصلته بحدوث اضطرابات في بلاده، فاضطر إلى رفع الحصار عن المدينة، وقفل عائداً إلى بلاده، وقد أرغم سليمان على التراجع معه لعجزه عن تحقيق وعده لقارلة بإدخاله سرقسطة.انسحب قارلة نحو غالة (فرنسا) ولما أدرك بنبلونة سحب حاميتها الإفرنجية وهدم أسوار المدينة. وقد أثار عليه ابن معاوية قبائل البشكنس، وكانوا يحقدون على قارلة لتخريبه بنبلونة، فترصدوا مؤخرة جيشه الكبير وهو يجتاز أحد دروب شعار رنسفالة، حتى قضوا على هذه المؤخرة قضاءً مبرماً وقتل في رنشفالة عدد كبير من أعاظم قواده، نخص بالذكر منهم إيجيهار، وأنسيلم، كما قتل صفيه وأعظم قواده رولان، فحزن قارلة لقتله حزناً شديداً، وكان مصرعه موضوع أنشودة من شعر الملاحم الفرنسي تعرف بأنشودة رولان.وفي أثناء المعركة تمكن مطروح وعيشون ولدا سليمان بن الأعرابي من تخليصه، ورجعا به إلى سرقسطة. وإثر تلك الموقعة يقول المقري: وخاطب عبد الرحمن قارلة ملك الإفرنج، وكان من طغاة الإفرنج بعد أن تمرس به مدة فأصابه، فمال معه إلى المداراة، ودعاه إلى المصاهرة والسلم، فأجابه للسلم ولم تتم المصاهرة. ولقد أيقن قارلة استحالة تفوقه على الإسلام في إسبانيا ما لم يؤمن بلاد غالة الإفرنجية والغرب المسيحي.وقد عمد في العام نفسه الذي عاد فيه إلى بلاده من حملته الفاشلة إلى ضم مملكة أكيتانيا إلى مملكة إفرنجة بقصد مراقبة نشاط أمراء المسلمين الموالين لقرطبة أو الخارجين على طاعتها، على تخوم البرتات (البيرينيه)، أو الحد من هذا النشاط. ومنح قارلة هذه المملكة الكالولنجية إلى ابنه لويس الذي سمي فيما بعد باسم لويس التقي، وتألفت من هذه المملكة ومملكتي غسقونية وسبتمانيا جبهة قوية تواجه أملاك المسلمين في إسبانيا، وقد آتت هذه السياسة الواقعية ثمرتها، إذ إن سكان المدن الإسلامية في إسبانيا، الواقعة بعيداً عن قرطبة كانوا يتوجهون بالطاعة لهذه الممالك، فقد حدث قبل وفاة عبد الرحمن الداخل أن سلم أهالي جرندة مدينتهم سنة 785م إلى ممثلي السلطات الإفرنجية، وتبع ضياع جرندة سقوط مدينة برشلونة في أيدي الفرنجة سنة 801م.القضاء على الثواروبينما كان جيش قارلة يتراجع عن سرقسطة كان جيش عبد الرحمن بن معاوية يتأهب للسير نحو سرقسطة للقضاء على الثوار. وقبل أن يصل الأمير عبد الرحمن إلى سرقسطة أوعز حسين بن يحيى الأنصاري إلى أحد أتباعه أن يقتل الأعرابي في المسجد الجامع سنة 164ه/ 780م، حتى ينفرد بحكم سرقسطة. أما عيشون بن سليمان، فقد فر بعد مصرع أبيه إلى أربونة، ثم عاد إلى سرقسطة عندما بلغه قدوم الأمير عبدالرحمن إليها وافتتاحها. وتمكن أخيراً من اصطياد قاتل أبيه وقتله، وانضم إلى جيش الأمير وساهم في حصار حسين بن يحيى.فلما ضاق حسين بهذا الحصار، أرسل إلى الأمير يطلب الصلح، وأرسل إليه ابنه سعيد رهينة، فقبل الأمير ذلك، وفك الحصار عن سرقسطة ومضى إلى بنبلونة وقلنيرة وكر على البشكنس ثم على بلاد الشرطانيس، ولكن سعيداً تمكن من الفرار وعاد إلى سرقسطة سنة 165م، فسّير إليه عبد الرحمن قائده غالب بن تمامة بن علقمة على رأس جيش حاصر به المدينة، ثم أدركه الأمير في العام التالي 166ه/ 782م، فترامى القوم إليه وأسلموا إليه حسيناً فقتله عبد الرحمن. وانتهت بذلك ثورة حسين بن يحيى.وكانت آخر حلقة من سلسلة هذه المؤامرات، مؤامرة دبرها ابن أخت الأمير عبد الرحمن الداخل، واسمه المغيرة بن الوليد بن معاوية سنة 168ه، وساعده فيها هذيل بن الصميل بن حاتم، وكشف عبد الرحمن المؤامرة، وقبض على المغيرة وهذيل واستنطقهما فاعترفا، فأمر بقتلهما.