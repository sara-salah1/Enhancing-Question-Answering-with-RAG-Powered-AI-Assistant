كان اليهود في المدينة هم دائماً البادين بالشر مع المسلمين، وكانت الدائرة تدور عليهم في كل مرة، وكانت فكرة القضاء على الإسلام والمسلمين هي الفكرة التي سيطرة على سادتهم فتارة يدفعهم إليها شعور الحقد والغيرة وتارة يدفعهم إليها شعور العداوة والبغضاء، وكان نقض العهد دائماً من طبيعتهم، رغم أن الرسول صلى الله عليه وسلم والمسلمين كانوا يحرصون على حسن المعاملة معهم وعدم إكراههم على الدخول في الإسلام .يذكر الدكتور أمين دويدار في كتاب صور من حياة الرسول صلى الله عليه وسلم أن حياة اليهود مع الرسول صلى الله عليه وسلم كانت سلسلة من الضغائن والأحقاد، ولكن النبي لم يكن يود أن يسايرهم في خصومتهم وكان ينتظر الفرصة ليصلح ما بينه وبينهم، وعندما تولى أسير بن رزام زعامة اليهود في خيبر عرض عليه الرسول صلى الله عليه وسلم أن يدخل في هدنة وسلام مع المسلمين، وبعث إليه بعبد الله بن رواحة مع ثلاثين من رجال الأنصار، فلما ذهبوا إليه عرضوا عليه أن يتراجع عن العداء مع المسلمين، فوافق في بداية الأمر بل عرض التحالف مع المسلمين، وفي الطريق حاول أن يغدر بعبد الله بن رواحه ويقتله فعاجله عبد الله بن رواحه وقتله .وعندما تولى سلام بن مشكم زعامة اليهود بعد أسير بن رزام سار على درب من سبقوه من زعماء اليهود في عداء المسلمين، بل حاول أن يجمع يهود الحجاز ليبادروا بالذهاب لقتال المسلمين في المدينة، وعلم رسول الله صلى الله عليه وسلم بذلك فأعد الجيش لمحاربة يهود خيبر .وتقع خيبر على بعد مئة ميل من المدينة من ناحية الشمال، وكانت واحة كبيرة ذات مزارع ونخيل وكانت مقسمة إلى حصون منيعة وكان رجالها مدربين على الحرب، وكان لديهم المال والسلاح الكثير، لكنهم يخشون الحرب في الميدان ولا يحاربون إلا أمام الحصون، وقد عرف الرسول صلى الله عليه وسلم طبيعتهم فسار إليهم ليغزوهم في عقر دارهم .تهاوي الحصونوخرج الرسول صلى الله عليه وسلم صلى الله عليه وسلم إلى خيبر في شهر المحرم في السنة السابعة من الهجرة وكان معه ألف وستمائه من أصحابه، وسار الرسول صلى الله عليه وسلم بالجيش حتى وصل إلى أرض خيبر، فلما وصلها نزل بواد يقال له الرجيع وهذا الوادي يقع بين خيبر وغطفان، ولجأ يهود خيبر إلى الحصون ونزل فيهم قول الله وظنوا أنهم مانعتهم حصونهم من الله فأتاهم الله من حيث لم يحتسبوا وقذف في قلوبهم الرعب .ويذكر الدكتور محمد الدسوقي في كتاب أيام في حياة محمد أن المعركة بدأت بقتال عنيف، وكلما حاول اليهود الخروج من الحصن دحرهم المسلمون، وطال الحصار وظل رسول الله يقاتلهم سبعة أيام، وبدأت تسقط حصون خيبر واحداً بعد الآخر، وكلما سقط حصن وجد المسلمون فيه الكثير من الشعير والتمر والأسلحة، وكان المسلمون قد أصابتهم مجاعة قبل أن يفتحوا تلك الحصون، فلما فتحها الله عليهم وجدوا فيها الكثير من الطعام، وخشى الرسول صلى الله عليه وسلم أن ينشغل المسلمون بالغنائم عن القتال فصاح في المسلمين قائلاً كلوا ولا تحملوا .وفي أحد الحصون التي فتحها المسلمون في خيبر وجدوا الكثير من السيوف والدروع وآلات الحرب، وكان الذي دلهم عليها أسير من يهود خيبر، وبعد أن فتح الرسول صلى الله عليه وسلم من حصونهم ما فتح وحاز من أموالهم ما حاز حاصرهم في آخر حصونهم لمدة عشرة أيام، ولما أيقنوا أنهم هالكون وخاسرون لا محالة، طلبوا من الرسول الصلح فوافق صلى الله عليه وسلم .أم المؤمنين صفيةواتفق كنانة بن الربيع مع الرسول صلى الله عليه وسلم على أن يحقن دماء من في حصونهم من المقاتلين وأن يخرجوا من خيبر بلا مال أو سلاح فوافق وقال لهم برئت منكم ذمة الله ورسوله، وبعد الصلح طلبوا من الرسول صلى الله عليه وسلم أن يتركهم يعملون في الأرض ويعطوه نصف ثمارها، وقالوا له نحن أعلم بها منكم، فوافق الرسول صلى الله عليه وسلم على ذلك، لأن الرسول صلى الله عليه وسلم لم تكن هناك غاية يبغيها من قتالهم أو إخراجهم من الأرض بعد أن ألقوا السلاح وأمن المسلمون جانبهم .وحرص الرسول صلى الله عليه وسلم على أن تقوم العلاقة بينه وبينهم على أساس المودة لا على أساس العداوة وإصطفى منهم صفية بنت حيي وخيرها بين أن يعتقها ويتزوجها أو أن يلحقها بأهلها فاختارت أن تكون له زوجة .وكان من بين الغنائم التي غنمها المسلمون في خيبر صحائف من التوراة، فجاء اليهود يطلبونها فأمر الرسول صلى الله عليه وسلم بتسليمها إليهم، مما جعل اليهود يشيرون إليه بالبنان ويشكرون له هذا الموقف لأنه لم يتعرض بسوء لصحفهم المقدسة، ولما فرغ الرسول صلى الله عليه وسلم من خيبر انصرف إلى يهود وادي القرى فحاصرهم حتى سلموا فصالحهم الرسول صلى الله عليه وسلم على ما صالح عليه أهل خيبر وقد قسم الرسول صلى الله عليه وسلم الغنائم على المسلمين .وبينما المسلمون في فرحهم بفتح خيبر قدم عليهم جعفر بن أبي طالب ومعه المسلمون الذين هاجروا إلى الحبشة، فسعد رسول الله صلى الله عليه وسلم بقدومه وضم جعفر إلى صدره وقبله بين عينيه وقال صلى الله عليه وسلم ما أدرى بأيهما أنا أسر بفتح خيبر أم بقدوم جعفر .